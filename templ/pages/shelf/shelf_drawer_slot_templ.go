// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
package shelf

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/yumenaka/comigo/templ/common"

func ShelfDrawerSlot() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<!-- 阅读历史记录列表 -->")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = ReadingHistory().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "<!-- 切换【显示文件名】--><label class=\"inline-flex items-center w-full my-2.5 cursor-pointer outline-offset-4 outline-double outline-2 hover:outline-3 rounded-sm\"><input type=\"checkbox\" :value=\"$store.shelf.showFilename\" x-on:click=\"$store.shelf.showFilename =!$store.shelf.showFilename\" class=\"sr-only peer\"><div class=\"relative w-11 min-w-[44px] h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div><span class=\"font-medium ms-3\" x-text=\"i18next.t('show_filename')\"></span></label><!-- 切换【简化标题/完整标题】--><label x-show=\"$store.shelf.showFilename\" class=\"inline-flex items-center w-full my-2.5 cursor-pointer outline-offset-4 outline-double outline-2 hover:outline-3 rounded-sm\"><input type=\"checkbox\" :value=\"$store.shelf.simplifyTitle\" x-on:click=\"$store.shelf.simplifyTitle =!$store.shelf.simplifyTitle\" class=\"sr-only peer\"><div class=\"relative w-11 min-w-[44px] h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div><span class=\"font-medium ms-3\" x-text=\"i18next.t('simplify_filename')\"></span></label><!-- 切换【显示文件图标】--><label class=\"inline-flex items-center w-full my-2.5 cursor-pointer outline-offset-4 outline-double outline-2 hover:outline-3 rounded-sm\"><input type=\"checkbox\" :value=\"$store.shelf.showFileIcon\" x-on:click=\"$store.shelf.showFileIcon =!$store.shelf.showFileIcon\" class=\"sr-only peer\"><div class=\"relative w-11 min-w-[44px] h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div><span class=\"font-medium ms-3\" x-text=\"i18next.t('show_file_icon')\"></span></label><!-- 阅读进度显示（百分比）  --><label class=\"inline-flex items-center w-full my-2.5 cursor-pointer outline-offset-4 outline-double outline-2 hover:outline-3 rounded-sm\"><input type=\"checkbox\" :value=\"$store.shelf.readingProgressPercent\" x-on:click=\"$store.shelf.readingProgressPercent =!$store.shelf.readingProgressPercent\" class=\"sr-only peer\"><div class=\"relative w-11 min-w-[44px] h-6 bg-green-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div><span class=\"font-medium ms-3\" x-text=\"$store.shelf.readingProgressPercent?i18next.t('reading_progress_percent'):i18next.t('reading_progress_page')\"></span></label><!-- 切换【新标签页打开】--><label class=\"inline-flex items-center w-full my-2.5 cursor-pointer outline-offset-4 outline-double outline-2 hover:outline-3 rounded-sm\"><input type=\"checkbox\" :value=\"$store.shelf.openInNewTab\" x-on:click=\"$store.shelf.openInNewTab =!$store.shelf.openInNewTab\" class=\"sr-only peer\"><div class=\"relative w-11 min-w-[44px] h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div><span class=\"font-medium ms-3\" x-text=\"i18next.t('open_in_new_tab')\"></span></label><!-- 切换【无限卷轴/分页卷轴/翻页阅读】的select-->")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = common.ReadModeSelect(true).Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

// ReadingHistory 阅读历史记录列表组件
func ReadingHistory() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var2 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var2 == nil {
			templ_7745c5c3_Var2 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "<div x-data=\"{ collapsed: $persist(true).as('shelf_collapsed'), bookmarks: [], loading: false }\" x-init=\"\n\t\t\t(async () => {\n\t\t\t\tloading = true;\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await fetch('/api/all_bookmarks');\n\t\t\t\t\tif (response.ok) {\n\t\t\t\t\t\tconst data = await response.json();\n\t\t\t\t\t\t// 过滤掉没有阅读记录的书签（PageIndex > 0），并按更新时间降序排序\n\t\t\t\t\t\tbookmarks = data.filter(item => item.book_mark.page_index > 0)\n\t\t\t\t\t\t\t.sort((a, b) => new Date(b.book_mark.updated_at) - new Date(a.book_mark.updated_at));\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('Failed to load bookmarks:', error);\n\t\t\t\t} finally {\n\t\t\t\t\tloading = false;\n\t\t\t\t}\n\t\t\t})();\n\t\t\" class=\"w-full my-2.5\"><!-- 折叠/展开按钮 --><button @click=\"collapsed = !collapsed\" class=\"inline-flex mb-1 items-center w-full cursor-pointer outline-offset-4 outline-double outline-2 hover:outline-3 rounded-sm\"><span class=\"font-medium ms-3\" x-text=\"i18next.t('reading_history')\"></span> <span class=\"ms-auto text-sm text-gray-500\" x-show=\"bookmarks.length > 0\" x-text=\"'(' + bookmarks.length + ')'\"></span> <svg class=\"w-5 h-5 transition-transform\" :class=\"{ 'rotate-90': !collapsed }\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 10 6\"><path stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m1 1 4 4 4-4\"></path></svg></button><!-- 阅读历史列表 --><div x-show=\"!collapsed\" x-transition class=\"mt-2 space-y-2 max-h-96 overflow-y-auto ddrop-shadow-lg ring-2 ring-gray-400 hover:ring-4 hover:ring-blue-500  outline-double outline-2 hover:outline-3 rounded-sm\"><!-- 加载中 --><div x-show=\"loading\" class=\"text-center text-gray-500 py-4\"><span x-text=\"i18next.t('loading')\"></span></div><!-- 空列表提示 --><div x-show=\"!loading && bookmarks.length === 0\" class=\"text-center text-gray-500 py-4\"><span x-text=\"i18next.t('no_reading_history')\"></span></div><!-- 书签列表 --><template x-for=\"item in bookmarks\" :key=\"item.book_info.id + '_' + item.book_mark.page_index\"><a :href=\"$store.global.getReadURL(item.book_info.id, item.book_mark.page_index)\" class=\"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors cursor-pointer\"><!-- 封面 --><div class=\"w-16 h-20 bg-cover bg-center rounded flex-shrink-0\" :style=\"'background-image: url(' + (item.book_info.cover.url.includes('api/get_file?') ? item.book_info.cover.url + '&resize_height=128' : item.book_info.cover.url) + ')'\"></div><!-- 信息 --><div class=\"flex-1 min-w-0\"><div class=\"font-medium text-sm truncate\" x-text=\"item.book_info.title || i18next.t('unknown')\"></div><div class=\"text-xs text-gray-500 mt-1\"><span x-text=\"item.book_mark.page_index + '/' + item.book_info.page_count\"></span> <span x-show=\"$store.shelf.readingProgressPercent\" class=\"ml-2\"><span x-text=\"Math.round((item.book_mark.page_index / item.book_info.page_count) * 100) + '%'\"></span></span></div></div></a></template></div></div>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

// SaveReadingProgress 定义 保存阅读进度到本地存储 的开关 暂时用不着
func SaveReadingProgress() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var3 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var3 == nil {
			templ_7745c5c3_Var3 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "<!-- 保存阅读进度到本地存储 SaveReadingProgress --><label class=\"inline-flex items-center w-full my-2.5 cursor-pointer outline-offset-4 outline-double outline-2 hover:outline-3 rounded-sm\"><input type=\"checkbox\" :value=\"$store.global.saveReadingProgress\" x-on:click=\"$store.global.saveReadingProgress =!$store.global.saveReadingProgress\" class=\"sr-only peer\"><div class=\"relative w-11 min-w-[44px] h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div><span class=\"font-medium ms-3\" x-text=\"i18next.t('save_page_num')\"></span></label>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
