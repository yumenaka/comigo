package plugins

import (
	"github.com/labstack/echo/v4"
	"github.com/yumenaka/comigo/config"
	"strings"
)

// ComigoXYZPlugin å½“åŸŸåä¸º comigo.xyz æ—¶ï¼Œæ”¹é€ é¡¶å±‚ä¹¦æ¶ä¸ºè½¯ä»¶é¡¹ç›®é¦–é¡µ
templ ComigoXYZPlugin(c echo.Context) {
	if config.GetCfg().EnablePlugin && config.GetCfg().IsPluginEnabled("comigo_xyz") && (c.Request().Host == "comigo.xyz" || strings.HasSuffix(c.Request().Host, ".comigo.xyz")) && (c.Request().URL.Path == "/" || c.Request().URL.Path == "/shelf" || c.Request().URL.Path == "/index.html") && c.Param("id") == "" {
		if config.GetCfg().Debug {
			<script>
				console.log("Comigo.xyzæ’ä»¶å·²å¯ç”¨");
			</script>
		}
		<script>
			// ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆåæ›¿æ¢ä¹¦æ¶å†…å®¹
			document.addEventListener("DOMContentLoaded", function () {
				const shelfMainArea = document.getElementById("ShelfMainArea");
				if (shelfMainArea) {
					// åˆ›å»ºé¡¹ç›®é¦–é¡µå†…å®¹
					const homePageContent = `
						<div class="comigo_plugin flex flex-col items-center justify-center min-h-screen w-full p-8 bg-gradient-to-br from-base-200 to-base-300">
							<div class="max-w-4xl w-full space-y-8">
								<!-- æ ‡é¢˜åŒºåŸŸ -->
								<div class="text-center space-y-4">
									<h1 class="text-5xl font-bold text-base-content">Comigo</h1>
									<p class="text-xl text-base-content/80">Simple Manga Reader Online</p>
									<p class="text-base text-base-content/60">åœ¨çº¿æ¼«ç”»é˜…è¯»å™¨ - æ”¯æŒ Linuxã€Windowsã€Mac OS</p>
								</div>
								
								<!-- åŠŸèƒ½ç‰¹æ€§ -->
								<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-12">
									<div class="bg-base-100 p-6 rounded-lg shadow-lg">
										<h3 class="text-xl font-semibold mb-2">ğŸ“š å¤šæ ¼å¼æ”¯æŒ</h3>
										<p class="text-base-content/70">æ”¯æŒ ZIPã€RARã€CBZã€EPUBã€PDF ç­‰å¤šç§æ¼«ç”»æ ¼å¼</p>
									</div>
									<div class="bg-base-100 p-6 rounded-lg shadow-lg">
										<h3 class="text-xl font-semibold mb-2">ğŸŒ è·¨å¹³å°</h3>
										<p class="text-base-content/70">æ”¯æŒ Linuxã€Windowsã€Mac OS ä¸‰å¤§æ“ä½œç³»ç»Ÿ</p>
									</div>
									<div class="bg-base-100 p-6 rounded-lg shadow-lg">
										<h3 class="text-xl font-semibold mb-2">ğŸ“± å“åº”å¼è®¾è®¡</h3>
										<p class="text-base-content/70">å®Œç¾é€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯è®¾å¤‡</p>
									</div>
									<div class="bg-base-100 p-6 rounded-lg shadow-lg">
										<h3 class="text-xl font-semibold mb-2">ğŸ”„ å¤šç§é˜…è¯»æ¨¡å¼</h3>
										<p class="text-base-content/70">æ”¯æŒç¿»é¡µæ¨¡å¼å’Œå·è½´æ¨¡å¼ï¼Œæ»¡è¶³ä¸åŒé˜…è¯»ä¹ æƒ¯</p>
									</div>
									<div class="bg-base-100 p-6 rounded-lg shadow-lg">
										<h3 class="text-xl font-semibold mb-2">ğŸ”’ å®‰å…¨å¯é </h3>
										<p class="text-base-content/70">æ”¯æŒ HTTPS å’Œç”¨æˆ·è®¤è¯ï¼Œä¿æŠ¤æ‚¨çš„éšç§</p>
									</div>
									<div class="bg-base-100 p-6 rounded-lg shadow-lg">
										<h3 class="text-xl font-semibold mb-2">âš¡ é«˜æ€§èƒ½</h3>
										<p class="text-base-content/70">å¿«é€Ÿæ‰«æå’ŒåŠ è½½ï¼Œæµç•…çš„é˜…è¯»ä½“éªŒ</p>
									</div>
								</div>
								
								<!-- é“¾æ¥åŒºåŸŸ -->
								<div class="flex flex-col md:flex-row justify-center items-center gap-4 mt-12">
									<a 
										href="https://github.com/yumenaka/comigo" 
										target="_blank"
										class="px-6 py-3 bg-base-content text-base-100 rounded-lg hover:bg-base-content/90 transition-colors font-semibold"
									>
										ğŸ“¦ GitHub ä»“åº“
									</a>
									<a 
										href="https://github.com/yumenaka/comigo/releases" 
										target="_blank"
										class="px-6 py-3 bg-primary text-primary-content rounded-lg hover:bg-primary/90 transition-colors font-semibold"
									>
										â¬‡ï¸ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
									</a>
								</div>
								
								<!-- ä½¿ç”¨è¯´æ˜ -->
								<div class="mt-12 bg-base-100 p-6 rounded-lg shadow-lg">
									<h2 class="text-2xl font-semibold mb-4">å¿«é€Ÿå¼€å§‹</h2>
									<ol class="list-decimal list-inside space-y-2 text-base-content/80">
										<li>ä¸‹è½½å¹¶è¿è¡Œ Comigo ç¨‹åº</li>
										<li>åœ¨è®¾ç½®ä¸­é…ç½®æ‚¨çš„ä¹¦åº“è·¯å¾„</li>
										<li>å¼€å§‹äº«å—é˜…è¯»ä½“éªŒï¼</li>
									</ol>
								</div>
							</div>
						</div>
					`;

					// æ›¿æ¢ä¹¦æ¶å†…å®¹
					shelfMainArea.innerHTML = homePageContent;
					shelfMainArea.className = "w-full h-full";
				}
			});
		</script>
		<style>
			/* ç¡®ä¿é¦–é¡µæ ·å¼æ­£ç¡®æ˜¾ç¤º */
			#ShelfMainArea {
				overflow: visible !important;
			}
		</style>
	}
}
